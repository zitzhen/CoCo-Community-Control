/*!
 * Copyright (c) 2023 by xiaohong2022
 */
var document=this.document,window=this.window,location=this.location;!function(){var d=d||{};d.scope={};d.createTemplateTagFirstArg=function(a){return a.raw=a};d.createTemplateTagFirstArgWithRaw=function(a,b){a.raw=b;return a};d.arrayIteratorImpl=function(a){var b=0;return function(){return b<a.length?{done:!1,value:a[b++]}:{done:!0}}};d.arrayIterator=function(a){return{next:d.arrayIteratorImpl(a)}};d.makeIterator=function(a){var b="undefined"!=typeof Symbol&&Symbol.iterator&&a[Symbol.iterator];if(b)return b.call(a);if("number"==typeof a.length)return d.arrayIterator(a);throw Error(String(a)+" is not an iterable or ArrayLike");};d.arrayFromIterator=function(a){for(var b,c=[];!(b=a.next()).done;)c.push(b.value);return c};d.arrayFromIterable=function(a){return a instanceof Array?a:d.arrayFromIterator(d.makeIterator(a))};d.ASSUME_ES5=!1;d.ASSUME_NO_NATIVE_MAP=!1;d.ASSUME_NO_NATIVE_SET=!1;d.SIMPLE_FROUND_POLYFILL=!1;d.ISOLATE_POLYFILLS=!1;d.FORCE_POLYFILL_PROMISE=!1;d.FORCE_POLYFILL_PROMISE_WHEN_NO_UNHANDLED_REJECTION=!1;d.objectCreate=d.ASSUME_ES5||"function"==typeof Object.create?Object.create:function(a){var b=function(){};b.prototype=a;return new b};d.defineProperty=d.ASSUME_ES5||"function"==typeof Object.defineProperties?Object.defineProperty:function(a,b,c){if(a==Array.prototype||a==Object.prototype)return a;a[b]=c.value;return a};d.getGlobal=function(a){a=["object"==typeof globalThis&&globalThis,a,"object"==typeof window&&window,"object"==typeof self&&self,"object"==typeof global&&global];for(var b=0;b<a.length;++b){var c=a[b];if(c&&c.Math==Math)return c}throw Error("Cannot find global object");};d.global=d.getGlobal(this);d.IS_SYMBOL_NATIVE="function"===typeof Symbol&&"symbol"===typeof Symbol("x");d.TRUST_ES6_POLYFILLS=!d.ISOLATE_POLYFILLS||d.IS_SYMBOL_NATIVE;d.polyfills={};d.propertyToPolyfillSymbol={};d.POLYFILL_PREFIX="$jscp$";d.polyfill=function(a,b,c,e){b&&(d.ISOLATE_POLYFILLS?d.polyfillIsolated(a,b,c,e):d.polyfillUnisolated(a,b,c,e))};d.polyfillUnisolated=function(a,b,c,e){c=d.global;a=a.split(".");for(e=0;e<a.length-1;e++){var l=a[e];if(!(l in c))return;c=c[l]}a=a[a.length-1];e=c[a];b=b(e);b!=e&&null!=b&&d.defineProperty(c,a,{configurable:!0,writable:!0,value:b})};d.polyfillIsolated=function(a,b,c,e){var l=a.split(".");a=1===l.length;e=l[0];e=!a&&e in d.polyfills?d.polyfills:d.global;for(var B=0;B<l.length-1;B++){var w=l[B];if(!(w in e))return;e=e[w]}l=l[l.length-1];c=d.IS_SYMBOL_NATIVE&&"es6"===c?e[l]:null;b=b(c);null!=b&&(a?d.defineProperty(d.polyfills,l,{configurable:!0,writable:!0,value:b}):b!==c&&(void 0===d.propertyToPolyfillSymbol[l]&&(c=1E9*Math.random()>>>0,d.propertyToPolyfillSymbol[l]=d.IS_SYMBOL_NATIVE?d.global.Symbol(l):d.POLYFILL_PREFIX+c+"$"+l),d.defineProperty(e,d.propertyToPolyfillSymbol[l],{configurable:!0,writable:!0,value:b})))};d.getConstructImplementation=function(){function a(){function c(){}new c;Reflect.construct(c,[],function(){});return new c instanceof c}if(d.TRUST_ES6_POLYFILLS&&"undefined"!=typeof Reflect&&Reflect.construct){if(a())return Reflect.construct;var b=Reflect.construct;return function(c,e,l){c=b(c,e);l&&Reflect.setPrototypeOf(c,l.prototype);return c}}return function(c,e,l){void 0===l&&(l=c);l=d.objectCreate(l.prototype||Object.prototype);return Function.prototype.apply.call(c,l,e)||l}};d.construct={valueOf:d.getConstructImplementation}.valueOf();d.underscoreProtoCanBeSet=function(){var a={a:!0},b={};try{return b.__proto__=a,b.a}catch(c){}return!1};d.setPrototypeOf=d.TRUST_ES6_POLYFILLS&&"function"==typeof Object.setPrototypeOf?Object.setPrototypeOf:d.underscoreProtoCanBeSet()?function(a,b){a.__proto__=b;if(a.__proto__!==b)throw new TypeError(a+" is not extensible");return a}:null;d.inherits=function(a,b){a.prototype=d.objectCreate(b.prototype);a.prototype.constructor=a;if(d.setPrototypeOf){var c=d.setPrototypeOf;c(a,b)}else for(c in b)if("prototype"!=c)if(Object.defineProperties){var e=Object.getOwnPropertyDescriptor(b,c);e&&Object.defineProperty(a,c,e)}else a[c]=b[c];a.superClass_=b.prototype};var J=function(a){a=VisibleWidget.call(this,a)||this;a.widgetLog("\u5236\u4f5c\u8005\uff1a\u5c0f\u5b8fXeLa");a.widgetLog("\u7f16\u7a0b\u732b\u4e2a\u4eba\u4e3b\u9875\uff1ahttps://shequ.codemao.cn/user/9232151");return a};d.inherits(J,VisibleWidget);J.prototype.start=function(a,b,c,e,l,B,w,E,F,t){var h=document.createElement("script");h.innerHTML="";h.setAttribute("text",a.split("\n").join("<br>"));h.setAttribute("color",b);h.setAttribute("opacity",e/100);h.setAttribute("size",c);h.setAttribute("angle",l);h.setAttribute("xpadding",B);h.setAttribute("ypadding",w);h.setAttribute("img",E);h.setAttribute("width",F);h.setAttribute("height",t);!function(){function z(){v.globalAlpha=Number(g.o);v.fillStyle=g.c;v.font=g.s+"px sans-serif"}function C(){x=y.width=window.innerWidth||document.documentElement.clientWidth||document.body.clientWidth;f=y.height=window.innerHeight||document.documentElement.clientHeight||document.body.clientHeight}function D(){v.clearRect(0,0,x,f);var r=[];if(""!==g.m){var m=new Image;m.crossOrigin="Anonymous";m.src=g.m}else r=g.t.split("<br>");for(var u=2*-x;u<2*x;u+=Number(g.x))for(var G=2*-f;G<2*f;G+=Number(g.y)){v.save();z();v.rotate(A/180*Number(g.a));if(""!==g.m)v.drawImage(m,u,G,g.w,g.h);else for(var H=0;H<r.length;H++)v.fillText(r[H],u,G+H*g.s);v.restore()}q(D)}function I(){var r=[].slice.call(document.documentElement.children);document.documentElement.insertBefore(y,r[0])}function p(){var r=[].slice.call(document.documentElement.children);getComputedStyle(y);r[0]!==y&&I();y.getContext=function(){};C();setTimeout(p,1)}var y=document.createElement("canvas",void 0),g=function(){var r=[].slice.call(document.getElementsByTagName("script"));r.slice(-1,void 0);return{i:r.length,t:h.getAttribute("text")||"WatermarkJs",o:h.getAttribute("opacity")||.3,c:h.getAttribute("color")||"#000",x:h.getAttribute("xpadding")||50,y:h.getAttribute("ypadding")||100,s:h.getAttribute("size")||12,a:h.getAttribute("angle")||-30,m:h.getAttribute("img")||"",w:h.getAttribute("width")||300,h:h.getAttribute("height")||300}}(),n="WatermarkJsCanvasId"+g.i,v=y.getContext("2d"),x,f,A=Math.PI,q=window.requestAnimationFrame||window.webkitRequestAnimationFrame||window.mozRequestAnimationFrame||window.oRequestAnimationFrame||window.msRequestAnimationFrame||function(r){window.setTimeout(r,1E3/60)},k=new MutationObserver(function(r){for(var m=0;m<r.length;m++)if("attributes"===r[m].type&&("width"===r[m].attributeName||"height"===r[m].attributeName))return;document.open();location.reload()});y.id=n;y.style.cssText="inset:0px!important;padding:0px!important;border:none!important;border-radius:0!important;margin:0px!important;z-index:2147483647!important;position:fixed!important;top:0px!important;bottom:0px!important;right:0px!important;left:0px!important;pointer-events:none!important;display:block!important;visibility:visible!important;opacity:1!important;transform:none!important;filter:none!important;";z();C();window.addEventListener("resize",C);k.observe(y,{attributes:!0,childList:!0,subtree:!0});p();D()}()};J.prototype.imgstart=function(a,b,c,e,l,B,w,E,F,t,h,z,C,D){var I=this;E/=100;return new Promise(function(p){var y=document.getElementById(a);if(!y)return I.widgetError("\u672a\u627e\u5230\u63a7\u4ef6");var g=y.children[0];if(!g)return I.widgetError("\u4e0d\u662f\u56fe\u7247\u6846\u63a7\u4ef6");var n=new Image;n.crossOrigin="Anonymous";n.src=g.src;n.onload=function(){function v(){f.save();f.font=w+"px sans-serif";var k=""!==z?C:f.measureText(A.sort(function(G,H){return H.length-G.length})[0]),r=""!==z?D:A.length*w;f.restore();if("all"==b)for(var m=2*-g.naturalWidth;m<2*g.naturalWidth;m+=Number(t))for(var u=2*-g.naturalHeight;u<2*g.naturalHeight;u+=Number(h)){f.save();f.globalAlpha=Number(E);f.fillStyle=B;f.font=w+"px sans-serif";f.rotate(Math.PI/180*Number(F));if(""!==z)f.drawImage(q,m-c,u-e,C,D);else for(k=0;k<A.length;k++)f.fillText(A[k],m-c,u+k*w-e);f.restore()}else{u=m=0;"left-top"===b?(m=0+c+t,u=0+e+h):"left-bottom"===b?(m=0+c+t,u=g.naturalHeight-r+e-h):"right-bottom"===b?(m=g.naturalWidth-k+c-t,u=g.naturalHeight-r+e-h):"right-top"===b?(m=g.naturalWidth-k+c-t,u=0+e+h):"top"===b?(m=g.naturalWidth/2-k/2+c+t,u=0+e+h):"bottom"===b?(m=g.naturalWidth/2-k/2+c+t,u=g.naturalHeight-r+e-h):"left"===b?(m=0+c+t,u=g.naturalHeight/2-r/2+e+h):"right"===b?(m=g.naturalWidth-k+c-t,u=g.naturalHeight/2-r/2+e+h):"center"===b&&(m=g.naturalWidth/2-k/2+c+t,u=g.naturalHeight/2-r/2+e+h);f.save();f.globalAlpha=Number(E);f.fillStyle=B;f.font=w+"px sans-serif";f.rotate(Math.PI/180*Number(F));if(""!==z)f.drawImage(q,m,u,C,D);else for(k=0;k<A.length;k++)f.fillText(A[k],m,u+k*w);f.restore()}m=x.toDataURL();y.style.backgroundImage="url("+m+")";g.src=String(m);x.remove();p(m)}var x=document.createElement("canvas");document.body.append(x);x.width=g.naturalWidth;x.height=g.naturalHeight;var f=x.getContext("2d");f.save();f.globalAlpha=1;f.drawImage(n,0,0,g.naturalWidth,g.naturalHeight);f.restore();var A=[];if(""!==z){var q=new Image;q.crossOrigin="Anonymous";q.src=z}else A=l.split("\n");q?q.onload=function(){v()}:v()}})};J.prototype.imgurlstart=function(a,b,c,e,l,B,w,E,F,t,h,z,C,D){E/=100;return new Promise(function(I){var p=new Image;p.crossOrigin="Anonymous";p.src=a;p.onload=function(){function y(){n.save();n.font=w+"px sans-serif";var f=""!==z?C:n.measureText(v.sort(function(r,m){return m.length-r.length})[0]),A=""!==z?D:v.length*w;n.restore();if("all"==b)for(var q=2*-p.naturalWidth;q<2*p.naturalWidth;q+=Number(t))for(var k=2*-p.naturalHeight;k<2*p.naturalHeight;k+=Number(h)){n.save();n.globalAlpha=Number(E);n.fillStyle=B;n.font=w+"px sans-serif";n.rotate(Math.PI/180*Number(F));if(""!==z)n.drawImage(x,q-c,k-e,C,D);else for(f=0;f<v.length;f++)n.fillText(v[f],q-c,k+f*w-e);n.restore()}else{k=q=0;"left-top"===b?(q=0+c+t,k=0+e+h):"left-bottom"===b?(q=0+c+t,k=p.naturalHeight-A+e-h):"right-bottom"===b?(q=p.naturalWidth-f+c-t,k=p.naturalHeight-A+e-h):"right-top"===b?(q=p.naturalWidth-f+c-t,k=0+e+h):"top"===b?(q=p.naturalWidth/2-f/2+c+t,k=0+e+h):"bottom"===b?(q=p.naturalWidth/2-f/2+c+t,k=p.naturalHeight-A+e-h):"left"===b?(q=0+c+t,k=p.naturalHeight/2-A/2+e+h):"right"===b?(q=p.naturalWidth-f+c-t,k=p.naturalHeight/2-A/2+e+h):"center"===b&&(q=p.naturalWidth/2-f/2+c+t,k=p.naturalHeight/2-A/2+e+h);n.save();n.globalAlpha=Number(E);n.fillStyle=B;n.font=w+"px sans-serif";n.rotate(Math.PI/180*Number(F));if(""!==z)n.drawImage(x,q,k,C,D);else for(f=0;f<v.length;f++)n.fillText(v[f],q,k+f*w);n.restore()}q=g.toDataURL();g.remove();I(q)}var g=document.createElement("canvas");document.body.append(g);g.width=p.naturalWidth;g.height=p.naturalHeight;var n=g.getContext("2d");n.save();n.globalAlpha=1;n.drawImage(p,0,0,p.naturalWidth,p.naturalHeight);n.restore();var v=[];if(""!==z){var x=new Image;x.crossOrigin="Anonymous";x.src=z}else v=l.split("\n");x?x.onload=function(){y()}:y()}})};exports.types={type:"XH_WATERMARK_WIDGET",icon:"icon-toolbox-feature",title:"\u6c34\u5370",platforms:["android","ios","web"],version:"1.1.0",auther:"\u5c0f\u5b8fXeLa",isInvisibleWidget:!0,isGlobalWidget:!0,properties:[],methods:[{key:"start",label:"\u5168\u5c4f\u6c34\u5370",params:[{key:"text",label:"\u6587\u672c\u5185\u5bb9",valueType:"multilineString",defaultValue:"CoCo",checkType:"string"},{key:"color",label:"\u6587\u672c\u989c\u8272",valueType:"color",defaultValue:"#000"},{key:"size",label:"\u6587\u672c\u5927\u5c0f",valueType:"number",defaultValue:"12"},{key:"opacity",label:"\u4e0d\u900f\u660e\u5ea6",valueType:"number",defaultValue:"10"},{key:"angle",label:"\u65b9\u5411",valueType:"number",defaultValue:"-30"},{key:"xpadding",label:"\u5de6\u53f3\u95f4\u8ddd",valueType:"number",defaultValue:"50"},{key:"ypadding",label:"\u4e0a\u4e0b\u95f4\u8ddd",valueType:"number",defaultValue:"100"},{key:"img",label:"\u56fe\u7247",valueType:"string",defaultValue:""},{key:"width",label:"\u56fe\u7247\u5bbd\u5ea6",valueType:"number",defaultValue:"100"},{key:"height",label:"\u56fe\u7247\u9ad8\u5ea6",valueType:"number",defaultValue:"50"}],blockOptions:{color:"#66ccff",inputsInline:!1}},{key:"imgstart",label:"\u56fe\u7247\u6c34\u5370",params:[{key:"imgid",label:"\u56fe\u7247\u6846\u63a7\u4ef6ID",valueType:"string",defaultValue:"\u8bf7\u5f00F12\u83b7\u53d6\uff01"},{key:"position",label:"\u4f4d\u7f6e",valueType:"string",dropdown:[{label:"\u5168\u90e8",value:"all"},{label:"\u5de6\u4e0a\u89d2",value:"left-top"},{label:"\u5de6\u4e0b\u89d2",value:"left-bottom"},{label:"\u53f3\u4e0a\u89d2",value:"right-top"},{label:"\u53f3\u4e0b\u89d2",value:"right-bottom"},{label:"\u6b63\u4e0a\u65b9",value:"top"},{label:"\u6b63\u4e0b\u65b9",value:"bottom"},{label:"\u6b63\u5de6\u65b9",value:"left"},{label:"\u6b63\u53f3\u65b9",value:"right"},{label:"\u5c45\u4e2d",value:"center"}]},{key:"offsetx",label:"X\u504f\u79fb",valueType:"number",defaultValue:0},{key:"offsety",label:"Y\u504f\u79fb",valueType:"number",defaultValue:0},{key:"text",label:"\u6587\u672c\u5185\u5bb9",valueType:"multilineString",defaultValue:"CoCo",checkType:"string"},{key:"color",label:"\u6587\u672c\u989c\u8272",valueType:"color",defaultValue:"#000"},{key:"size",label:"\u6587\u672c\u5927\u5c0f",valueType:"number",defaultValue:"12"},{key:"opacity",label:"\u4e0d\u900f\u660e\u5ea6",valueType:"number",defaultValue:"10"},{key:"angle",label:"\u65b9\u5411",valueType:"number",defaultValue:"-30"},{key:"xpadding",label:"\u5de6\u53f3\u95f4\u8ddd",valueType:"number",defaultValue:"50"},{key:"ypadding",label:"\u4e0a\u4e0b\u95f4\u8ddd",valueType:"number",defaultValue:"100"},{key:"img",label:"\u56fe\u7247",valueType:"string",defaultValue:""},{key:"width",label:"\u56fe\u7247\u5bbd\u5ea6",valueType:"number",defaultValue:"100"},{key:"height",label:"\u56fe\u7247\u9ad8\u5ea6",valueType:"number",defaultValue:"50"}],blockOptions:{color:"#66ccff",inputsInline:!1}},{key:"imgurlstart",label:"\u56fe\u7247\u81ea\u5b9a\u4e49\u94fe\u63a5\u6c34\u5370",params:[{key:"url",label:"\u94fe\u63a5",valueType:"string",defaultValue:""},{key:"position",label:"\u4f4d\u7f6e",valueType:"string",dropdown:[{label:"\u5168\u90e8",value:"all"},{label:"\u5de6\u4e0a\u89d2",value:"left-top"},{label:"\u5de6\u4e0b\u89d2",value:"left-bottom"},{label:"\u53f3\u4e0a\u89d2",value:"right-top"},{label:"\u53f3\u4e0b\u89d2",value:"right-bottom"},{label:"\u6b63\u4e0a\u65b9",value:"top"},{label:"\u6b63\u4e0b\u65b9",value:"bottom"},{label:"\u6b63\u5de6\u65b9",value:"left"},{label:"\u6b63\u53f3\u65b9",value:"right"},{label:"\u5c45\u4e2d",value:"center"}]},{key:"offsetx",label:"X\u504f\u79fb",valueType:"number",defaultValue:0},{key:"offsety",label:"Y\u504f\u79fb",valueType:"number",defaultValue:0},{key:"text",label:"\u6587\u672c\u5185\u5bb9",valueType:"multilineString",defaultValue:"CoCo",checkType:"string"},{key:"color",label:"\u6587\u672c\u989c\u8272",valueType:"color",defaultValue:"#000"},{key:"size",label:"\u6587\u672c\u5927\u5c0f",valueType:"number",defaultValue:"12"},{key:"opacity",label:"\u4e0d\u900f\u660e\u5ea6",valueType:"number",defaultValue:"10"},{key:"angle",label:"\u65b9\u5411",valueType:"number",defaultValue:"-30"},{key:"xpadding",label:"\u5de6\u53f3\u95f4\u8ddd",valueType:"number",defaultValue:"50"},{key:"ypadding",label:"\u4e0a\u4e0b\u95f4\u8ddd",valueType:"number",defaultValue:"100"},{key:"img",label:"\u56fe\u7247",valueType:"string",defaultValue:""},{key:"width",label:"\u56fe\u7247\u5bbd\u5ea6",valueType:"number",defaultValue:"100"},{key:"height",label:"\u56fe\u7247\u9ad8\u5ea6",valueType:"number",defaultValue:"50"},{label:"\u8fd4\u56de\u94fe\u63a5"}],valueType:"string",blockOptions:{color:"#66ccff",inputsInline:!1}}],events:[]};exports.widget=J}();