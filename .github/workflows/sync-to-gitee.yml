name: Sync GitHub Repo to Gitee
permissions:
  contents: read

on:
  push:
    branches:
      - main  # ç›‘å¬ main åˆ†æ”¯æ¨é€äº‹ä»¶

jobs:
  sync-main:
    name: Sync Main Repo to Gitee
    runs-on: ubuntu-latest
    env:
      GITEE_USERNAME: hello-oliver
      GITEE_ORG: zitzhen
      GITEE_REPO: CoCo-Community-Control
      GITEE_TOKEN: ${{ secrets.GITEE_TOKEN }}

    steps:
      - name: Clone GitHub Repo
        run: |
          echo "ğŸš€ å…‹éš† GitHub ä¸»ä»“åº“..."
          git clone --bare https://github.com/zitzhen/CoCo-Community-Control.git repo
          cd repo

          echo "ğŸ”— æ·»åŠ  Gitee è¿œç¨‹ä»“åº“..."
          git remote remove gitee 2>/dev/null || true
          git remote add gitee "https://${GITEE_USERNAME}:${GITEE_TOKEN}@gitee.com/${GITEE_ORG}/${GITEE_REPO}.git"

          echo "âœ… éªŒè¯è¿œç¨‹ï¼š"
          git remote -v

          echo "â¬†ï¸ æ¨é€æ‰€æœ‰åˆ†æ”¯å’Œæ ‡ç­¾åˆ° Gitee..."
          git push gitee --all --verbose
          git push gitee --tags --verbose

          echo "ğŸ‰ ä¸»ä»“åº“æ¨é€å®Œæˆï¼"